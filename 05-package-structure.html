
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Deciding Package Structure &#8212; MolSSI Best Practices  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=f098cca5" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-FHKVGE8HKZ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-FHKVGE8HKZ');
            </script>
    <script>DOCUMENTATION_OPTIONS.pagename = '05-package-structure';</script>
    <link rel="icon" href="_static/molssi_square.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Type Hinting in Python" href="06-type-hinting.html" />
    <link rel="prev" title="Python Coding Style" href="04-function-style.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/molssi_main_logo.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">MolSSI Best Practices</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="00-setup.html">
                        Set-Up
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="00-git-and-github.html">
                        git and GitHub
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="00-code-organization-documentation.html">
                        Code Style and Documentation
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="00-testing-continuous-integration.html">
                        Testing, Continuous Integration, and Distribution
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://molssi.org">
                    MolSSI
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MolSSI-Education/python-package-best-practices" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="index.html">
                        Overview
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="00-setup.html">
                        Set-Up
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="00-git-and-github.html">
                        git and GitHub
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="00-code-organization-documentation.html">
                        Code Style and Documentation
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="00-testing-continuous-integration.html">
                        Testing, Continuous Integration, and Distribution
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://molssi.org">
                    MolSSI
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/MolSSI-Education/python-package-best-practices" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="00-code-organization-documentation.html" class="nav-link">Code Style and Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Deciding...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="deciding-package-structure">
<h1>Deciding Package Structure<a class="headerlink" href="#deciding-package-structure" title="Link to this heading">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions:</p>
<ul class="simple">
<li><p>How should I organize my code?</p></li>
<li><p>How can I handle imports in my package?</p></li>
</ul>
<p>Objectives:</p>
<ul class="simple">
<li><p>Break code into modules and subpackages based on functionality.</p></li>
<li><p>Understand how the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file affects your Python package.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Follow Along with This Lesson</p>
<p>To follow along with this lesson, you can complete the previous lessons,
or you can download a pre-made workshop repository that is at the starting
point.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/MolSSI-Education/molecool/archive/refs/tags/deciding-package-structure-start.zip">Download the pre-made workshop repository as a zip file</a></p></li>
</ul>
<p>Alternatively, download the repository using the command line:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-shell" for="sd-tab-item-0">
SHELL</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/MolSSI-Education/molecool.git
git<span class="w"> </span>checkout<span class="w"> </span>deciding-package-structure-start
</pre></div>
</div>
</div>
</div>
</div>
<p>As new features are implemented in codes, it is natural for new functions and objects to be added.
In many projects, this often leads to a large number of functionalities defined within a single module.
For small, single developer codes, this is not a major issue, but it can still make code difficult to work with.
With large or multi-developer codes, this can slow development progress to a crawl as it is difficult both to understand and work with the code.</p>
<p>In this lesson, we will simulate a developing piece of software.
We will start with a single python module containing all the methods we have developed,
and convert it into a well-structured package.</p>
<section id="package-structure">
<h2>Package Structure<a class="headerlink" href="#package-structure" title="Link to this heading">#</a></h2>
<p>Let’s start by reviewing the package structure provided to us by the <a class="reference external" href="https://github.com/MolSSI/cookiecutter-cms">CMS CookieCutter</a>.
We have a directory containing our project with a number of additional features.
Under our package directory, <code class="docutils literal notranslate"><span class="pre">molecool</span></code>, we can see our current python module <code class="docutils literal notranslate"><span class="pre">functions.py</span></code>.
For a more detailed explanation of the rest of the package structure,
please review the <a class="reference external" href="https://molssi-education.github.io/python-package-best-practices/01-package-setup/index.html">package setup</a> section of the lessons.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── CODE_OF_CONDUCT.md              &lt;- Code of Conduct for developers and users
├── LICENSE                         &lt;- License file
├── MANIFEST.in                     &lt;- Packaging information for pip
├── README.md                       &lt;- Description of project which GitHub will render
├── molecool                        &lt;- Basic Python Package import file
│   ├── __init__.py                 &lt;- Basic Python Package import file
│   ├── functions.py                &lt;- Starting package module
│   ├── data                        &lt;- Sample additional data (non-code) which can be packaged. Just an example, delete in production
│   │   ├── README.md
│   │   └── look_and_say.dat
│   └── tests                       &lt;- Unit test directory with sample tests
│       ├── __init__.py
│       └── test_molecool.py
├── devtools                        &lt;- Deployment, packaging, and CI helpers directory
│   ├── README.md
│   ├── conda-envs                  &lt;- Conda environments for testing
│   │   └── test_env.yaml
│   └── scripts
│       └── create_conda_env.py     &lt;- OS agnostic Helper script to make conda environments based on simple flags
├── docs                            &lt;- Documentation template folder with many settings already filled in
│   ├── Makefile
│   ├── README.md                   &lt;- Instructions on how to build the docs
│   ├── _static
│   │   └── README.md
│   ├── _templates
│   │   └── README.md
│   ├── api.rst
│   ├── conf.py
│   ├── getting_started.rst
│   ├── index.rst
│   ├── make.bat
│   └── requirements.yaml           &lt;- Documenation building specific requirements. Usually a smaller set than the main program
├── readthedocs.yml
├── pyproject.toml                  &lt;- Generic Python build system configuration (PEP-517).
├── setup.cfg                       &lt;- Near-master config file to make house INI-like settings for Coverage, Flake8, YAPF, etc.
├── setup.py                        &lt;- Your package&#39;s setup file for installing with additional options that can be set
├── .codecov.yml                    &lt;- Codecov config to help reduce its verbosity to more reasonable levels
├── .github                         &lt;- GitHub hooks for user contribution, pull request guides and GitHub Actions CI
│   ├── CONTRIBUTING.md
│   ├── PULL_REQUEST_TEMPLATE.md
│   └── workflows
│       └── CI.yaml
├── .gitignore                      &lt;- Stock helper file telling git what file name patterns to ignore when adding files
└── .lgtm.yml
</pre></div>
</div>
<p>The easiest way to start is to see what we currently have and try to decide which parts are related to one another.
Looking through the <code class="docutils literal notranslate"><span class="pre">functions.py</span></code> file, we see a number of different functions,
and for the sake of simplicity we abbreviate and rearrange them here:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-1" name="sd-tab-set-1" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-functions.py" for="sd-tab-item-1">
FUNCTIONS.PY</label><div class="sd-tab-content docutils">
<div class="highlight-functions.py notranslate"><div class="highlight"><pre><span></span><span class="n">atomic_weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">1.00784</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">12.0107</span><span class="p">,</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">14.0067</span><span class="p">,</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">15.999</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mf">30.973762</span><span class="p">,</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">18.998403</span><span class="p">,</span>
    <span class="s1">&#39;Cl&#39;</span><span class="p">:</span> <span class="mf">35.453</span><span class="p">,</span>
    <span class="s1">&#39;Br&#39;</span><span class="p">:</span> <span class="mf">79.904</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">atom_colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;#D3D3D3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="s1">&#39;#add8e6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFA500&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFE0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cl&#39;</span><span class="p">:</span> <span class="s1">&#39;#98FB98&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Br&#39;</span><span class="p">:</span> <span class="s1">&#39;#F4A460&#39;</span><span class="p">,</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">open_pdb</span><span class="p">(</span><span class="n">file_location</span><span class="p">):</span>
    <span class="o">...</span>
   
<span class="k">def</span> <span class="nf">open_xyz</span><span class="p">(</span><span class="n">file_location</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">write_xyz</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
    <span class="o">...</span>
    
<span class="k">def</span> <span class="nf">calculate_distance</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">rB</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">calculate_angle</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">rB</span><span class="p">,</span> <span class="n">rC</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">draw_molecule</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">draw_bonds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">bond_histogram</span><span class="p">(</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">save_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">graph_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">graph_max</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">build_bond_list</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">max_bond</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">min_bond</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="o">...</span>
    
<span class="k">def</span> <span class="nf">calculate_molecular_mass</span><span class="p">(</span><span class="n">symbols</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">calculate_center_of_mass</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<p>Right at the start we can see two dictionaries of atom data. Clearly these are related and should probably be grouped together.
Looking at the functions, we see two functions that handle opening files, <code class="docutils literal notranslate"><span class="pre">open_pdb</span></code> and <code class="docutils literal notranslate"><span class="pre">open_xyz</span></code>, and a function that writes a file, <code class="docutils literal notranslate"><span class="pre">write_xyz</span></code>.
It may make sense to group these three together in a module based on input and output.</p>
<p>Let’s start making new modules to place our related functions into.</p>
<section id="atom-data">
<h3>Atom Data<a class="headerlink" href="#atom-data" title="Link to this heading">#</a></h3>
<p>We will take the <code class="docutils literal notranslate"><span class="pre">atomic_weights</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_colors</span></code> dictionaries and move them into a separate module called <code class="docutils literal notranslate"><span class="pre">atom_data.py</span></code>.
This is enclosing the constant data that our system is using in a single place.
This allows all the new modules we create to access the data from a single location, avoiding the need to copy the dictionaries to each module that needs them.
If we have any other data, related to atoms, used by many of our functions, adding them to this module would be a good idea.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-2" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-atom_data.py" for="sd-tab-item-2">
ATOM_DATA.PY</label><div class="sd-tab-content docutils">
<div class="highlight-atom_data.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data used for the rest of the package.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">atomic_weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">1.00784</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">12.0107</span><span class="p">,</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">14.0067</span><span class="p">,</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">15.999</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mf">30.973762</span><span class="p">,</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">18.998403</span><span class="p">,</span>
    <span class="s1">&#39;Cl&#39;</span><span class="p">:</span> <span class="mf">35.453</span><span class="p">,</span>
    <span class="s1">&#39;Br&#39;</span><span class="p">:</span> <span class="mf">79.904</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">atom_colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;#D3D3D3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="s1">&#39;#add8e6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFA500&#39;</span><span class="p">,</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFE0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cl&#39;</span><span class="p">:</span> <span class="s1">&#39;#98FB98&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Br&#39;</span><span class="p">:</span> <span class="s1">&#39;#F4A460&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exercise-grouping-into-modules">
<h2>Exercise - Grouping into Modules<a class="headerlink" href="#exercise-grouping-into-modules" title="Link to this heading">#</a></h2>
<div class="exercise admonition">
<p class="admonition-title">Exercise - Grouping into Modules</p>
<p>Take approximately 10 minutes to look through the rest of the functions in the <code class="docutils literal notranslate"><span class="pre">functions</span></code> module and group them together.
Create a module for each group with a reasonable name.</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Here is how we decided to break up the functions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calculate_angle</span></code> and <code class="docutils literal notranslate"><span class="pre">calculate_distance</span></code> go together in a <code class="docutils literal notranslate"><span class="pre">measure</span></code> module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw_molecule</span></code> and <code class="docutils literal notranslate"><span class="pre">bond_histogram</span></code> go into a <code class="docutils literal notranslate"><span class="pre">visualize</span></code> module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">build_bond_list</span></code> is placed into a <code class="docutils literal notranslate"><span class="pre">molecule</span></code> module.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">open_pdb</span></code> go into a <code class="docutils literal notranslate"><span class="pre">pdb</span></code> module in an <code class="docutils literal notranslate"><span class="pre">io</span></code> subpackage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">open_xyz</span></code> and <code class="docutils literal notranslate"><span class="pre">write_xyz</span></code> are placed into an <code class="docutils literal notranslate"><span class="pre">xyz</span></code> module in an <code class="docutils literal notranslate"><span class="pre">io</span></code> subpackage.</p></li>
</ul>
</div>
</div>
<section id="measure-module">
<h3>Measure Module<a class="headerlink" href="#measure-module" title="Link to this heading">#</a></h3>
<p>Our <code class="docutils literal notranslate"><span class="pre">functions.py</span></code> file contains two functions that handle taking measurements:
<code class="docutils literal notranslate"><span class="pre">calculate_distance</span></code> and <code class="docutils literal notranslate"><span class="pre">calculate_angle</span></code>.
Similar to <code class="docutils literal notranslate"><span class="pre">atom_data</span></code>, we will simply place these in a module within the main package.
Since both functions are taking measurements, we will call it <code class="docutils literal notranslate"><span class="pre">measure.py</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-3" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-measure.py" for="sd-tab-item-3">
MEASURE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-measure.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module is for functions that perform measurements.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">calculate_distance</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">rB</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the distance between two points.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rA, rB : np.ndarray</span>
<span class="sd">        The coordinates of each point.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    distance : float</span>
<span class="sd">        The distance between the two points.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; r1 = np.array([0, 0, 0])</span>
<span class="sd">    &gt;&gt;&gt; r2 = np.array([0, 0.1, 0])</span>
<span class="sd">    &gt;&gt;&gt; calculate_distance(r1, r2)</span>
<span class="sd">    0.1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dist_vec</span> <span class="o">=</span> <span class="n">rA</span> <span class="o">-</span> <span class="n">rB</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dist_vec</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">distance</span>

<span class="k">def</span> <span class="nf">calculate_angle</span><span class="p">(</span><span class="n">rA</span><span class="p">,</span> <span class="n">rB</span><span class="p">,</span> <span class="n">rC</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">AB</span> <span class="o">=</span> <span class="n">rB</span> <span class="o">-</span> <span class="n">rA</span>
    <span class="n">BC</span> <span class="o">=</span> <span class="n">rB</span> <span class="o">-</span> <span class="n">rC</span>
    <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">AB</span><span class="p">,</span> <span class="n">BC</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">BC</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">theta</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualize-module">
<h3>Visualize Module<a class="headerlink" href="#visualize-module" title="Link to this heading">#</a></h3>
<p>Similarly, we have two functions that handle visualization of molecules.
We will place them into a module called <code class="docutils literal notranslate"><span class="pre">visualize.py</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-4" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-visualize.py" for="sd-tab-item-4">
VISUALIZE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-visualize.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for visualization of molecules</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">draw_molecule</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">draw_bonds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>

    <span class="c1"># Create figure</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>

    <span class="c1"># Get colors - based on atom name</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_colors</span><span class="p">[</span><span class="n">atom</span><span class="p">])</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.markersize&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">200</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
        <span class="n">facecolors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Draw bonds</span>
    <span class="k">if</span> <span class="n">draw_bonds</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">bond_length</span> <span class="ow">in</span> <span class="n">draw_bonds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">atom1</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">bond_histogram</span><span class="p">(</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">save_location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">graph_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">graph_max</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">lengths</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">bond_length</span> <span class="ow">in</span> <span class="n">bond_list</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond_length</span><span class="p">)</span>
    
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">graph_min</span><span class="p">,</span> <span class="n">graph_max</span><span class="p">)</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Bond Length (angstrom)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number of Bonds&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
    
    <span class="c1"># Save figure</span>
    <span class="k">if</span> <span class="n">save_location</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_location</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ax</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="molecule-module">
<h3>Molecule Module<a class="headerlink" href="#molecule-module" title="Link to this heading">#</a></h3>
<p>Our last function is <code class="docutils literal notranslate"><span class="pre">build_bond_list</span></code>, which is not particularly related to any of our other functions.
The name <code class="docutils literal notranslate"><span class="pre">functions.py</span></code> does not really give a lot of information about what is available in the module.
We can rename the module to something more fitting, say <code class="docutils literal notranslate"><span class="pre">molecule.py</span></code>.
We also add a docstring.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-5" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-molecule.py" for="sd-tab-item-5">
MOLECULE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-molecule.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for molecule analysis</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">build_bond_list</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">max_bond</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">min_bond</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build a list of bonds in a set of coordinates based on a distance criteria.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates: np.ndarray</span>
<span class="sd">        The coordinates of the atoms to analyze in an (natoms, ndim) array.</span>

<span class="sd">    max_bond: float, optional</span>
<span class="sd">        The maximum distance for two atoms to be considered bonded.</span>

<span class="sd">    min_bond: float, optional</span>
<span class="sd">        The minimum distance for two atoms to be considered bonded.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bonds: dict</span>
<span class="sd">        A dictionary containing bonded atoms with atom pairs as keys and the distance between the atoms as the value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Find the bonds in a molecule (set of coordinates) based on distance criteria.</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">atom1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">atom2</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">atom1</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">):</span>
            <span class="n">distance</span> <span class="o">=</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="n">atom1</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">atom2</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">distance</span> <span class="o">&gt;</span> <span class="n">min_bond</span> <span class="ow">and</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="n">max_bond</span><span class="p">:</span>
                <span class="n">bonds</span><span class="p">[(</span><span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">)]</span> <span class="o">=</span> <span class="n">distance</span>

    <span class="k">return</span> <span class="n">bonds</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="i-o-subpackage">
<h3>I/O Subpackage<a class="headerlink" href="#i-o-subpackage" title="Link to this heading">#</a></h3>
<p>When looking at the three I/O functions,
it may be easy to jump ahead and create an I/O module, as mentioned previously.
However, what we really have is two distinct groups of functions that are related.
More specifically,
we have two functions that handle the input and output of a <code class="docutils literal notranslate"><span class="pre">.xyz</span></code> file
and another function that handles the input of a <code class="docutils literal notranslate"><span class="pre">.pdb</span></code>.
Each group is handling input and output,
but are still somewhat unrelated because of their file type.
Instead of making a single module,
we are going to create a subpackage to handle i/o and place a module for each group within it.</p>
<p>Create a new directory called “io” within the package (using the command ‘mkdir directory_name’) and create two new files <code class="docutils literal notranslate"><span class="pre">pdb.py</span></code> and <code class="docutils literal notranslate"><span class="pre">xyz.py</span></code> (using the command <code class="docutils literal notranslate"><span class="pre">touch</span> <span class="pre">file_name</span></code>):</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-6" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-io/pdb.py" for="sd-tab-item-6">
IO/PDB.PY</label><div class="sd-tab-content docutils">
<div class="highlight-io/pdb.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for manipulating pdb files.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">open_pdb</span><span class="p">(</span><span class="n">file_location</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open and read coordinates and atom symbols from a pdb file.</span>

<span class="sd">    The pdb file must specify the atom elements in the last column, and follow</span>
<span class="sd">    the conventions outlined in the PDB format specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_location : str</span>
<span class="sd">        The location of the pdb file to read in.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coords : np.ndarray</span>
<span class="sd">        The coordinates of the pdb file.</span>
<span class="sd">    symbols : list</span>
<span class="sd">        The atomic symbols of the pdb file.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;ATOM&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;HETATM&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]:</span>
            <span class="n">symbols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">79</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">atom_coords</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
            <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_coords</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coords</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-7" name="sd-tab-set-7" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-io/xyz.py" for="sd-tab-item-7">
IO/XYZ.PY</label><div class="sd-tab-content docutils">
<div class="highlight-io/xyz.py notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">functions for manipulating xyz files.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">open_xyz</span><span class="p">(</span><span class="n">file_location</span><span class="p">):</span>

    <span class="c1"># Open an xyz file and return symbols and coordinates.</span>
    <span class="n">xyz_file</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">file_location</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;unicode&quot;</span><span class="p">)</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">xyz_file</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coords</span>


<span class="k">def</span> <span class="nf">write_xyz</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">):</span>

    <span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">num_atoms</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;write_xyz : the number of symbols (</span><span class="si">{</span><span class="n">num_atoms</span><span class="si">}</span><span class="s2">) and number of coordinates (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span><span class="si">}</span><span class="s2">) must be the same to write xyz file!&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;XYZ file</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\t</span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">symbols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now any module that needs to handle input and output can import the needed module from the <code class="docutils literal notranslate"><span class="pre">io</span></code> subpackage.
Since these are currently small modules, it would not be a big deal to import all of them.
But, consider a large I/O suite containing a large number of file types and functionalities.
It will quickly create inefficiencies to leave them in one module.</p>
<p>Now that we’ve organized and changed the structure in our project,
we should commit our changes and push to GitHub.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-8" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-shell" for="sd-tab-item-8">
SHELL</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;organize molecool into modules and subpackage&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>main
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="fixing-imports">
<h2>Fixing Imports<a class="headerlink" href="#fixing-imports" title="Link to this heading">#</a></h2>
<p>When we first copied the functions from the Jupyter Notebook into <code class="docutils literal notranslate"><span class="pre">functions.py</span></code>,
we were able to import <code class="docutils literal notranslate"><span class="pre">molecool</span></code> package and access the functions within <code class="docutils literal notranslate"><span class="pre">functions.py</span></code>.
After we extracted the functions from that file, we won’t be able to import those functions in the same way.
In fact, we won’t be able to access them at all.
Every time we restructure our code or create new folders we have to be careful and modify the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> accordingly.
Let us then add the new functions into the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-9" name="sd-tab-set-9" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-__init__.py" for="sd-tab-item-9">
__INIT__.PY</label><div class="sd-tab-content docutils">
<div class="highlight-__init__.py notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add imports here</span>
<span class="kn">from</span> <span class="nn">.functions</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.measure</span> <span class="kn">import</span> <span class="n">calculate_distance</span><span class="p">,</span> <span class="n">calculate_angle</span>
<span class="kn">from</span> <span class="nn">.molecule</span> <span class="kn">import</span> <span class="n">build_bond_list</span>
<span class="kn">from</span> <span class="nn">.visualize</span> <span class="kn">import</span> <span class="n">draw_molecule</span><span class="p">,</span> <span class="n">bond_histogram</span>
</pre></div>
</div>
</div>
</div>
<p>In this way, we should be able to call each of the functions after importing our module.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-10" name="sd-tab-set-10" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-10">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">molecool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecool</span><span class="o">.</span><span class="n">build_bond_list</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Even with the imports fixed, if you try to run some of these functions,
you may find yourself with an <code class="docutils literal notranslate"><span class="pre">ImportError</span></code>.
This is because the functions can only see the code that has been “loaded” into their module.
Each set of functions now exist in the context of their module “namespace”.</p>
<p>If we look at our original <code class="docutils literal notranslate"><span class="pre">functions.py</span></code> module,
we will see that we had a number of import statements at the top of the file:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-11" name="sd-tab-set-11" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-original_functions.py" for="sd-tab-item-11">
ORIGINAL_FUNCTIONS.PY</label><div class="sd-tab-content docutils">
<div class="highlight-original_functions.py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>These are modules that are needed by some functions.
Now that we have moved the functions into separate modules,
we need to add the <code class="docutils literal notranslate"><span class="pre">import</span></code> statements into each file where they are needed.
Let’s start by looking at <code class="docutils literal notranslate"><span class="pre">measure.py</span></code>.
Looking through the functions, we can see that each of them has a reference to <code class="docutils literal notranslate"><span class="pre">np</span></code>,
which is what we imported <code class="docutils literal notranslate"><span class="pre">numpy</span></code> as in <code class="docutils literal notranslate"><span class="pre">functions.py</span></code>.</p>
<p>Aside from visual inspection,
you could have also seen these missing imports by using <code class="docutils literal notranslate"><span class="pre">flake8</span></code> on the modules.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-12" name="sd-tab-set-12" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-shell" for="sd-tab-item-12">
SHELL</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>flake8<span class="w"> </span>measure.py
</pre></div>
</div>
</div>
</div>
<p>You will see a message which says “undefined name np”.</p>
<p>In order to make these functions work again, we need to add the following <code class="docutils literal notranslate"><span class="pre">import</span></code> statement.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-13" name="sd-tab-set-13" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-13">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>to the top of our file.</p>
<p>As a second example, let us look at the <code class="docutils literal notranslate"><span class="pre">visualize.py</span></code> module.
We can quickly see that there is a reference to <code class="docutils literal notranslate"><span class="pre">np</span></code> in each of the methods,
so we need to add our <code class="docutils literal notranslate"><span class="pre">numpy</span></code> import statement again.
We also see references to <code class="docutils literal notranslate"><span class="pre">plt</span></code> which was the name given to <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> when it was imported.
Add imports of the external libraries to the top of the <code class="docutils literal notranslate"><span class="pre">visualize.py</span></code> module.
Of course, don’t forget our “unused import” for 3D axes.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-14" name="sd-tab-set-14" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-visualize.py" for="sd-tab-item-14">
VISUALIZE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-visualize.py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>  <span class="c1"># noqa: F401</span>
</pre></div>
</div>
</div>
</div>
<p>If you use <code class="docutils literal notranslate"><span class="pre">flake8</span></code> (or if you carefully inspect), you will also see that <code class="docutils literal notranslate"><span class="pre">atom_colors</span></code> is missing.
The <code class="docutils literal notranslate"><span class="pre">draw_molecule</span></code> function uses the <code class="docutils literal notranslate"><span class="pre">atom_colors</span></code> dictionary.
When all of our code was in a single module, we could simply reference the dictionary by name and use it.
However, we have now moved <code class="docutils literal notranslate"><span class="pre">atom_colors</span></code> and <code class="docutils literal notranslate"><span class="pre">atomic_weights</span></code> into a separate module.
In order to reference the dictionaries in <code class="docutils literal notranslate"><span class="pre">visualize.py</span></code>, we need to import them using an import statement.
This is an intra-package import, meaning that we are importing modules from within our packages to other imports in our package (see intra package imports <a class="reference external" href="https://docs.python.org/3/tutorial/modules.html">here</a>)</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-15" name="sd-tab-set-15" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-visualize.py" for="sd-tab-item-15">
VISUALIZE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-visualize.py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.atom_data</span> <span class="kn">import</span> <span class="n">atom_colors</span>
</pre></div>
</div>
</div>
</div>
<p>This import statement looks a bit different from the other import statements in our code, we have a <code class="docutils literal notranslate"><span class="pre">.</span></code> before the name.
This is because it is a <em>relative import</em>. Just like when using bash, a dot (<code class="docutils literal notranslate"><span class="pre">.</span></code>) means to look in the current folder.</p>
<p>To think about this more, let’s first look at the dot in a different <code class="docutils literal notranslate"><span class="pre">import</span></code> statement:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-16" name="sd-tab-set-16" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-16">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">.</span></code> is saying look within the package <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and grab the subpackage (or module) <code class="docutils literal notranslate"><span class="pre">pyplot</span></code>.
In our case, we are not using a name before the <code class="docutils literal notranslate"><span class="pre">.</span></code> so where is it looking?
It is looking within the current package/directory, or in this case <code class="docutils literal notranslate"><span class="pre">molecool</span></code> for a module or package named <code class="docutils literal notranslate"><span class="pre">atom_data</span></code>, from which it will import the <code class="docutils literal notranslate"><span class="pre">atom_colors</span></code> dictionary.</p>
<section id="check-your-understanding-relative-imports">
<h3>Check your Understanding - Relative Imports<a class="headerlink" href="#check-your-understanding-relative-imports" title="Link to this heading">#</a></h3>
<div class="exercise admonition">
<p class="admonition-title">Check your Understanding</p>
<p>The <code class="docutils literal notranslate"><span class="pre">molecule.py</span></code> module also utilizes functions that are no longer available in the module.
Correct the missing import statements in the module.</p>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The <code class="docutils literal notranslate"><span class="pre">build_bond_list</span></code> functions utilizes the <code class="docutils literal notranslate"><span class="pre">calculate_distance</span></code> function, which is now in the <code class="docutils literal notranslate"><span class="pre">measure</span></code> module, so we want to create a relative import from the <code class="docutils literal notranslate"><span class="pre">measure</span></code> module.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-17" name="sd-tab-set-17" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-molecule.py" for="sd-tab-item-17">
MOLECULE.PY</label><div class="sd-tab-content docutils">
<div class="highlight-molecule.py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.measure</span> <span class="kn">import</span> <span class="n">calculate_distance</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="using-import">
<h3>Using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code><a class="headerlink" href="#using-import" title="Link to this heading">#</a></h3>
<p>We have moved all of our functions into modules and we’ve updated our <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file.
If you use a Python interpreter in a directory which is not directly above your project, you can see the consequences of this.
We can use the <code class="docutils literal notranslate"><span class="pre">dir</span></code> functions to see what is available in a particular module or object:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-18" name="sd-tab-set-18" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-18">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">molecool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">molecool</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You should see something similar to the following</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-19" name="sd-tab-set-19" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-output" for="sd-tab-item-19">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[&#39;__builtins__&#39;, &#39;__cached__&#39;, &#39;__doc__&#39;, &#39;__file__&#39;, &#39;__git_revision__&#39;, &#39;__loader__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__path__&#39;, &#39;__spec__&#39;, &#39;__version__&#39;, &#39;_version&#39;, &#39;functions&#39;, &#39;np&#39;, &#39;plt&#39;, &#39;calculate_distance&#39;, &#39;calculate_angle,</span>
<span class="go">&#39;build_bond_list&#39;, &#39;draw_molecule&#39;, &#39;bond_histogram&#39; ]</span>
</pre></div>
</div>
</div>
</div>
<p>These are all the things available to us from importing <code class="docutils literal notranslate"><span class="pre">molecool</span></code>.
You will see your <code class="docutils literal notranslate"><span class="pre">functions</span></code> module, but you will also see <code class="docutils literal notranslate"><span class="pre">np</span></code> and <code class="docutils literal notranslate"><span class="pre">plt</span></code>.
This comes from using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">.functions</span> <span class="pre">import</span> <span class="pre">*</span></code> and is why using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code> is usually considered a bad practice.</p>
<p>Since we are no longer using any code from <code class="docutils literal notranslate"><span class="pre">functions.py</span></code>, we will remove the statement importing it from <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.</p>
</section>
<section id="io-subpackage">
<h3>IO Subpackage<a class="headerlink" href="#io-subpackage" title="Link to this heading">#</a></h3>
<p>We haven’t yet included our <code class="docutils literal notranslate"><span class="pre">io</span></code> subpackage, meaning that the user would have to import this package if they wanted to use it.
For example, to use the xyz functions,</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-20" name="sd-tab-set-20" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-20">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">molecool.io.xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="n">molecool</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">open_xyz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This will work, however, the main reason we broke up the modules within the <code class="docutils literal notranslate"><span class="pre">io</span></code> package was for development convenience.
Right now this has come at the cost of slightly more complicated import statements to get access to any function.</p>
<p>We can, of course, edit our <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file to make this simpler.
At this point, the way we actually do this import is going to be stylistic - how do you want people to interact with your package?</p>
<p>The goal we are going for is to call an IO function using</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-21" name="sd-tab-set-21" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-21">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">molecool</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">IO_FUNCTION</span>
</pre></div>
</div>
</div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">IO_FUNCTION</span></code> is any function relating to IO.</p>
<p>Within the <code class="docutils literal notranslate"><span class="pre">io</span></code> directory, create a new file called <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>.
Open that file with your desired editor and add the following two lines.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-22" name="sd-tab-set-22" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-__init__.py" for="sd-tab-item-22">
__INIT__.PY</label><div class="sd-tab-content docutils">
<div class="highlight-__init__.py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.pdb</span> <span class="kn">import</span> <span class="n">open_pdb</span>
<span class="kn">from</span> <span class="nn">.xyz</span> <span class="kn">import</span> <span class="n">open_xyz</span><span class="p">,</span> <span class="n">write_xyz</span>
</pre></div>
</div>
</div>
</div>
<p>These lines are relative import statements to the functions within the <code class="docutils literal notranslate"><span class="pre">io</span></code> package.
Think of them as pointers to the functions.
When we look at the <code class="docutils literal notranslate"><span class="pre">io</span></code> package, it directs us to the location of the underlying functions,
so we do not need to look within each submodule.
This allows us to use the following <code class="docutils literal notranslate"><span class="pre">import</span></code> statement to our top level <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> to access the functions:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-23" name="sd-tab-set-23" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-__init__.py" for="sd-tab-item-23">
__INIT__.PY</label><div class="sd-tab-content docutils">
<div class="highlight-__init__.py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">io</span>
</pre></div>
</div>
</div>
</div>
<p>We can now call our I/O functions using our target syntax.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-24" name="sd-tab-set-24" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-24">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecool</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">open_pdb</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>If we wanted the I/O functions to mimic the imports from the rest of the modules,
we could modify our top level <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file to reflect that.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-25" name="sd-tab-set-25" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-__init__.py" for="sd-tab-item-25">
__INIT__.PY</label><div class="sd-tab-content docutils">
<div class="highlight-__init__.py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.measure</span> <span class="kn">import</span> <span class="n">calculate_distance</span><span class="p">,</span> <span class="n">calculate_angle</span>
<span class="kn">from</span> <span class="nn">.molecule</span> <span class="kn">import</span> <span class="n">build_bond_list</span>
<span class="kn">from</span> <span class="nn">.visualize</span> <span class="kn">import</span> <span class="n">draw_molecule</span><span class="p">,</span> <span class="n">bond_histogram</span>
<span class="kn">from</span> <span class="nn">.io</span> <span class="kn">import</span> <span class="n">open_pdb</span><span class="p">,</span> <span class="n">open_xyz</span><span class="p">,</span> <span class="n">write_xyz</span>
</pre></div>
</div>
</div>
</div>
<p>We could even make these functions more accessible by removing the need for the  <code class="docutils literal notranslate"><span class="pre">io</span></code> module.</p>
<p>This would allow us to call functions by simply typing the following.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-26" name="sd-tab-set-26" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-python" for="sd-tab-item-26">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecool</span><span class="o">.</span><span class="n">open_pdb</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You can now appreciate how the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file plays such an important role in defining how the user imports the functions in the package.</p>
<p>Now that we’ve made some changes to <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>,
we should commit our changes and push to GitHub.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-27" name="sd-tab-set-27" type="radio">
</input><label class="sd-tab-label" data-sync-id="tabcode-shell" for="sd-tab-item-27">
SHELL</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;fixing imports&quot;</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>main
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Final Repository State</p>
<p>You can see the final state of the repository after this section <a class="reference external" href="https://github.com/MolSSI-Education/molecool/tree/5b7642b7fa140a833bc618a1561bc4a08d433257">here</a>.</p>
<p>You can also download a zip of the repository <a class="reference external" href="https://github.com/MolSSI-Education/molecool/archive/refs/tags/deciding-package-structure-end.zip">here</a>.</p>
</div>
</section>
</section>
<section id="key-points">
<h2>Key Points<a class="headerlink" href="#key-points" title="Link to this heading">#</a></h2>
<div class="key admonition">
<p class="admonition-title">Key Points</p>
<ul class="simple">
<li><p>Your package should be broken up into modules and subpackages depending on the amount of code and functionality.</p></li>
<li><p>You can use the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file to define what packages are imported with your package, and how the user interacts with it.</p></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04-function-style.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python Coding Style</p>
      </div>
    </a>
    <a class="right-next"
       href="06-type-hinting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Type Hinting in Python</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-structure">Package Structure</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#atom-data">Atom Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-grouping-into-modules">Exercise - Grouping into Modules</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#measure-module">Measure Module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-module">Visualize Module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#molecule-module">Molecule Module</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#i-o-subpackage">I/O Subpackage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fixing-imports">Fixing Imports</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-your-understanding-relative-imports">Check your Understanding - Relative Imports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-import">Using <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#io-subpackage">IO Subpackage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-points">Key Points</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/05-package-structure.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  



  
  
  
  
  
  
  


<div class="row h-10">
    <div class="col-2">
        <a href="https://molssi.org/" target="_blank" title="Go to MolSSI in a new tab">
            <img src="_static/molssi_main_logo.png" class="logo__image only-light footer_logo" alt="Logo image">
            <img src="_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark footer_logo" alt="Logo image">
        </a>
    </div>
    <div class="col-8">
        <p> &copy; Copyright 2019-2023 <a href="https://molssi.org/">The Molecular Sciences Software Institute</a></p>
        <p>Funded by the National Science Foundation 
          <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1547580">OAC-1547580</a> and 
          <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2136142">CHE-2136142.</a></p>
        <p> The MolSSI Best Practices Workshop is licesened under a <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 International License.</a> 
            You are free to adapt and share this material with attribution.
            We'd also appreciate you letting us know if you use the material by emailing <a href="mailto:education@molssi.org">education@molssi.org</a>.
          </p>
        
 
        
        <p class="sphinx-version">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br>
        </p>
        

        <p class="theme-version">
        Built with a customized <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.1.
        </p>

    </div>
    <div class="col-2">
        <a href="https://nsf.gov/" target="_blank" title="Go to the NSF in a new tab">
            <img src="_static/nsf.png" class="footer_logo" alt="The NSF">
          </a>
    </div>
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>